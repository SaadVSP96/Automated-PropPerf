clc;clear variables;close all
%lecture slides at all radial positions but for one climb velocity only
%defining some more constants
C_d_o = 0.008;
%defining radial positions
R_ft = (42/2)/12;%ft
r_by_R = [0.0424416670000000,0.0441083330000000,0.0457750000000000,0.0474416670000000,0.0491000000000000,0.0507666670000000,0.0524333330000000,0.0542083330000000,0.0567583330000000,0.0599250000000000,0.0632166670000000,0.0665333330000000,0.0698500000000000,0.0731666670000000,0.0764833330000000,0.0798000000000000,0.0831083330000000,0.0864250000000000,0.0897416670000000,0.0930583330000000,0.0963750000000000,0.0996916670000000,0.103008333000000,0.106325000000000,0.109633333000000,0.112950000000000,0.116266667000000,0.119583333000000,0.122900000000000,0.126216667000000,0.129533333000000,0.132850000000000,0.136158333000000,0.139475000000000,0.142791667000000,0.146108333000000,0.149425000000000,0.152741667000000,0.156058333000000,0.159375000000000,0.162683333000000,0.165991667000000,0.169158333000000,0.171883333000000,0.174291667000000]./R_ft;
c_ft = [0.0325916670000000,0.0323750000000000,0.0321833330000000,0.0320083330000000,0.0318666670000000,0.0317333330000000,0.0316333330000000,0.0315416670000000,0.0314666670000000,0.0314333330000000,0.0314916670000000,0.0316333330000000,0.0318750000000000,0.0321916670000000,0.0326000000000000,0.0329750000000000,0.0332750000000000,0.0334916670000000,0.0336416670000000,0.0337083330000000,0.0337000000000000,0.0336250000000000,0.0334666670000000,0.0332333330000000,0.0329250000000000,0.0325416670000000,0.0320750000000000,0.0315416670000000,0.0309333330000000,0.0302416670000000,0.0294833330000000,0.0286416670000000,0.0277250000000000,0.0267416670000000,0.0256750000000000,0.0245333330000000,0.0233166670000000,0.0220250000000000,0.0206583330000000,0.0192083330000000,0.0176916670000000,0.0160500000000000,0.0134666670000000,0.00940000000000000,8.33333000000000e-06];%ft
theta_deg = [33.4582000000000,32.4830000000000,31.5596000000000,30.6843000000000,29.8539000000000,29.0653000000000,28.3157000000000,27.5554000000000,26.5314000000000,25.3597000000000,24.2431000000000,23.2148000000000,22.2697000000000,21.3989000000000,20.5944000000000,19.8488000000000,19.1559000000000,18.5104000000000,17.9079000000000,17.3441000000000,16.8157000000000,16.3194000000000,15.8526000000000,15.4126000000000,14.9973000000000,14.6047000000000,14.2324000000000,13.8788000000000,13.5425000000000,13.2222000000000,12.9166000000000,12.6247000000000,12.3454000000000,12.0779000000000,11.8212000000000,11.5745000000000,11.3370000000000,11.1080000000000,10.8866000000000,10.6722000000000,10.4636000000000,10.2614000000000,10.0800000000000,9.93110000000000,8.65370000000000];%deg
C_l_a_per_rad = ones(1,length(r_by_R)).*(5.7); %1/rad
Omega = 1000;%RPM - to - rad/s
Omega_R_fts = Omega*R_ft;%tip speed - ft/s
V_fts = 1*1.46667;%mph - to - ft/s
N_b = 2;%number of blades
%calling the function and producing the matrices at all radials-for V_climb = 0
for i = 1:1:length(r_by_R)
  [theta_deg(i),theta_rad(i),phi_rad(i),alpha_deg(i),C_l(i),Lambda(i),Lambda_c(i),sigma(i)]=...
   CBEMT_w_tip_losses_function(r_by_R(i),c_ft(i),theta_deg(i),C_l_a_per_rad(i),R_ft,...
   Omega_R_fts,V_fts,N_b);
end
%now moving towards the calculation of C_T and C_P
%for C_T
X1 = r_by_R;
Y1 = (sigma/2).*(r_by_R.^2).*C_l;
C_T = trapz(X1,Y1)
%for C_P
X2 = r_by_R;
Y2_a = (sigma/2).*(r_by_R.^3).*C_d_o;
Y2_b = (sigma/2).*(r_by_R.^3).*C_l.*phi_rad;
C_P = trapz(X2,Y2_a)+trapz(X2,Y2_b)
%PLOTS:
%Making the inflow ratio graph on slide 33
plot(r_by_R,Lambda,'c','LineWidth',1.5)
xlabel('Radial Locations - (r/R)')
ylabel('Inflow Ratio')
title('Inflow Ratio Variation with Radial Location')
grid on
%Making the Sectional lift vs radial location graph on slide 28
figure(2)
plot(r_by_R,C_l,'b','LineWidth',1.5)
xlabel('Radial Locations - (r/R)')
ylabel('Section Lift - C_l')
title('Section Lift Variation with Radial Location')
grid on
%now moving towards the calculation of C_T and C_P
%for C_T
X1 = r_by_R;
Y1 = (r_by_R.^2).*C_l;
figure(3)
plot(X1,Y1,'r','LineWidth',2)
grid on
title('For C_T');xlabel('Radial Locations - (r/R)');
ylabel('Thrust, (r/R)^2*C_l')
%for C_P
X2 = r_by_R;
Y2 = (r_by_R.^3).*C_l.*phi_rad;
figure(4)
plot(X2,Y2,'g','LineWidth',2)
grid on
title('For C_P');xlabel('Radial Locations - (r/R)');
ylabel('Power, (r/R)^3*C_l*phi')

